# This Sigma detection tailored to the CVE-2025-21204 exploit chain described in the article. 

title: CVE-2025-21204 Windows Update Stack Junction Hijacking
id: 8d01029e-5d5f-4671-8a08-762afb830a18
status: 
description: Detects a suspicious program or command line action
references:
    - Internal Research
    - https://cyberdom.blog/abusing-the-windows-update-stack-to-gain-system-access-cve-2025-21204/
author: Jaspreet S
date: 2025-02-08
modified: 
logsource:
    category: process_creation
    product: windows
detection:
  selection_junction:
    Image|endswith: '\cmd.exe'
    CommandLine|contains|all:
      - 'mklink'
      - '/J'
      - 'Microsoft\UpdateStack\Tasks'
  selection_payload:
    Image|endswith: '\powershell.exe'
    CommandLine|contains|all:
      - 'New-Item'
      - 'inetpub\wwwroot'
      - 'UpdateStackAgent.dll'
  selection_execution:
    ParentImage|endswith: '\MoUsoCoreWorker.exe'
    Image|endswith: '\cmd.exe'
    CommandLine|contains: 'C:\inetpub\wwwroot\'
  condition: selection_junction or selection_payload or selection_execution

